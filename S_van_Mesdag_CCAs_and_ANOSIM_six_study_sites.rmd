---
title: "S_van_Mesdag_CCAs_and_ANOSIM_Six_Study_Sites"
author: "Savanna van Mesdag"
date: "2023-09-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

##The following is written by Savanna van Mesdag, going through the relevant coding and analyses for CCAs and ANOSIMs for the plant and substrate data for the six study sites.

#setwd#

#To run the following code to carry out the analyses, the following packages must be installed#

```{R}

install.packages("vegan", repos = "https://github.com/vegandevs/vegan")

install.packages("ggplot2", repos = "https://github.com/tidyverse/ggplot2")

```

#Once installed, then need to load these r packages...

```{R}

library(vegan)
library(ggplot2)

```
#Loading the data files...

```{R}

urlfile1 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/Plant_Species_BD.csv'

PlantSpecies <-read.csv(urlfile1)

urlfile2 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/Plant_Chemistry_BD.csv'

PlantChemistry <-read.csv(urlfile2)

```

#Need to do this to make sure the datasets are good to go.

```{R}

col_sums     <- apply(X = PlantSpecies, MARGIN = 2, FUN = sum);
rm           <- which(is.na(col_sums) == TRUE);
PlantSpecies <- PlantSpecies[, -rm];

print(PlantSpecies)

```

#Now to do some ANOSIM tests to assess any significant differences
#between plant species in different chemical variables.

```{R}

anoSiO2 <- anosim(PlantSpecies, PlantChemistry$SiO2, distance = "bray", permutations = 9999)

anoSiO2

```

#This initial test demonstrates significant differences between plants in different SiO2 #concentrations, with a high ANOSIM statistic, 0.7017, and a low p value of 0.0427.

```{R}

anoAl2O3 <- anosim(PlantSpecies, PlantChemistry$Al2O3, distance = "bray", permutations = 9999)

anoAl2O3

```

#We do not see significant differences for the Al2O3 concentrations. Further significant #differences highlighted for each relevant test...

```{R}

anoCaO <- anosim(PlantSpecies, PlantChemistry$CaO, distance = "bray", permutations = 9999)

anoCaO

anoMgO <- anosim(PlantSpecies, PlantChemistry$MgO, distance = "bray", permutations = 9999)

anoMgO

anoNa2O <- anosim(PlantSpecies, PlantChemistry$Na2O, distance = "bray", permutations = 9999)

anoNa2O

anoK2O <- anosim(PlantSpecies, PlantChemistry$K2O, distance = "bray", permutations = 9999)

anoK2O

anoCr2O3 <- anosim(PlantSpecies, PlantChemistry$Cr2O3, distance = "bray", permutations = 9999)

anoCr2O3

```

#ANOSIM statistic of 0.2463, with low p value of 0.0015. Significant differences between # plants on different Cr2O3 concentrations.

```{R}

anoTiO2 <- anosim(PlantSpecies, PlantChemistry$TiO2, distance = "bray", permutations = 9999)

anoTiO2

anoMnO <- anosim(PlantSpecies, PlantChemistry$MnO, distance = "bray", permutations = 9999)

anoMnO

anoP2O5 <- anosim(PlantSpecies, PlantChemistry$P2O5, distance = "bray", permutations = 9999)

anoP2O5

```

#ANOSIM statistic of 0.2941, with a low p value of 0.0066.There are significant differences #between plants in different P2O5 concentrations.

```{R}

anoSrO <- anosim(PlantSpecies, PlantChemistry$SrO, distance = "bray", permutations = 9999)

anoSrO

anoBaO <- anosim(PlantSpecies, PlantChemistry$BaO, distance = "bray", permutations = 9999)

anoBaO

```

#ANOSIM statistic of 0.2961, with a low p value of 0.0029.There are significant differences #between plants in different BaO concentrations.

```{R}

anoAl <- anosim(PlantSpecies, PlantChemistry$Al, distance = "bray", permutations = 9999)

anoAl

anoAs <- anosim(PlantSpecies, PlantChemistry$As, distance = "bray", permutations = 9999)

anoAs

anoAg <- anosim(PlantSpecies, PlantChemistry$Ag, distance = "bray", permutations = 9999)

anoAg

anoB <- anosim(PlantSpecies, PlantChemistry$B, distance = "bray", permutations = 9999)

anoB

anoBa <- anosim(PlantSpecies, PlantChemistry$Ba, distance = "bray", permutations = 9999)

anoBa

```

#ANOSIM statistic of 0.357, with a low p value of 0.0236.There are significant differences #between plants in different Ba concentrations.

```{R}

anoBe <- anosim(PlantSpecies, PlantChemistry$Be, distance = "bray", permutations = 9999)

anoBe

```

#Skipping Bi as the values are all so similar and small.

```{R}

anoCa <- anosim(PlantSpecies, PlantChemistry$Ca, distance = "bray", permutations = 9999)

anoCa

```

#High ANOSIM statistic of 0.6018, with a low p value of 0.0343.There are significant #differences between plants in different Ca concentrations.

```{R}

anoCd <- anosim(PlantSpecies, PlantChemistry$Cd, distance = "bray", permutations = 9999)

anoCd

anoCo <- anosim(PlantSpecies, PlantChemistry$Co, distance = "bray", permutations = 9999)

anoCo

```

#ANOSIM statistic of 0.2712, with a low p value of 0.0071.There are significant differences #between plants in different Co concentrations.

```{R}

anoCr <- anosim(PlantSpecies, PlantChemistry$Cr, distance = "bray", permutations = 9999)

anoCr

```

#ANOSIM statistic of 0.4565, with a low p value of 0.0087. There are significant #differences between plants in different Cr concentrations.

```{R}

anoCu <- anosim(PlantSpecies, PlantChemistry$Cu, distance = "bray", permutations = 9999)

anoCu

anoFe <- anosim(PlantSpecies, PlantChemistry$Fe, distance = "bray", permutations = 9999)

anoFe

```

#Skipped Ga and Hg due to similarity in values.

```{R}

anoK <- anosim(PlantSpecies, PlantChemistry$K, distance = "bray", permutations = 9999)

anoK

```

#Skipping La and Li due to similarities of values

```{R}

anoMg <- anosim(PlantSpecies, PlantChemistry$Mg, distance = "bray", permutations = 9999)

anoMg

anoMn <- anosim(PlantSpecies, PlantChemistry$Mn, distance = "bray", permutations = 9999)

anoMn

```

#High ANOSIM statistic of 0.6336, with a low p value of 0.026. There are significant #differences between plants in different Mn concentrations.

```{R}

anoMo <- anosim(PlantSpecies, PlantChemistry$Mo, distance = "bray", permutations = 9999)

anoMo

anoNa <- anosim(PlantSpecies, PlantChemistry$Na, distance = "bray", permutations = 9999)

anoNa

```

#ANOSIM statistic of 0.1796, with a low p value of 0.0269. There are significant #differences between plants in different Na concentrations.

```{R}

anoNi <- anosim(PlantSpecies, PlantChemistry$Ni, distance = "bray", permutations = 9999)

anoNi

```

#ANOSIM statistic of 0.2407, with a low p value of 0.035. There are significant differences #between plants in different Ni concentrations.

```{R}

anoP <- anosim(PlantSpecies, PlantChemistry$P, distance = "bray", permutations = 9999)

anoP

anoPb <- anosim(PlantSpecies, PlantChemistry$Pb, distance = "bray", permutations = 9999)

anoPb

anoS <- anosim(PlantSpecies, PlantChemistry$S, distance = "bray", permutations = 9999)

anoS

```

#ANOSIM statistic of 0.2553, with a low p value of 0.0384. There are significant #differences between plants in different S concentrations.

```{R}

anoSb <- anosim(PlantSpecies, PlantChemistry$Sb, distance = "bray", permutations = 9999)

anoSb

anoSc <- anosim(PlantSpecies, PlantChemistry$Sc, distance = "bray", permutations = 9999)

anoSc

anoSr <- anosim(PlantSpecies, PlantChemistry$Sr, distance = "bray", permutations = 9999)

anoSr

```

#ANOSIM statistic of 0.464, with a low p value of 0.0366. There are significant differences #between plants in different Sr concentrations.

#Skipping Th because of similarities in values

```{R}

anoTi <- anosim(PlantSpecies, PlantChemistry$Ti, distance = "bray", permutations = 9999)

anoTi

```

#Skipping Tl and U beccause of similarities in values

```{R}

anoV <- anosim(PlantSpecies, PlantChemistry$V, distance = "bray", permutations = 9999)

anoV

```

#Skipping W because of similarities in values

```{R}

anoZn <- anosim(PlantSpecies, PlantChemistry$Zn, distance = "bray", permutations = 9999)

anoZn

```

#13 out of 49 substrate variables show statistically significant differences for  plant #species growing in those same sample locations. Will do CCA for the whole dataset, but #will start off with an analysis with those 13 substrate variables only.

#The initial CCA with the basic parameters and without specific substrate variables #selected. The dataset used includes too many variables for an anova P value to be #generated, as shown when attempting an anova below.

```{R}

plant_cca <- cca(PlantSpecies, PlantChemistry, na.action = na.omit);
print(plant_cca);
plot(plant_cca)
summary(plant_cca)
anova(plant_cca)

```

#Now to do a CCA with the 13 statistically significant variables as 
#determined by the ANOSIM tests

```{R}

Plant_CCA_Chem <- cca(PlantSpecies ~ SiO2 + Cr2O3 + P2O5 + BaO + Ba + Ca + Co + Cr + Mn + Na + Ni + S + Sr, data = PlantChemistry)

plot(Plant_CCA_Chem)
summary(Plant_CCA_Chem)
anova(Plant_CCA_Chem)

```

#What is interesting about the plot generated for this CCA is that, while most of the #arrows are very long, some of the arrows are much shorter, especially that of Cr2O3. This #would indicate that Cr2O3, in particular, does not actually greatly influence plant  #species throughout the study sites. While some of these variables are likely still  #important to consider, it is worthwhile looking through all of the potential variables,
#including mineral data, to look for the most influential variables for plant species
#presence.

#The following CCAs were carried out to determine which chemistry variables
#most strongly influenced plant species presence, which included removing variables
#with particularly short arrows, especially compared with variables with much longer arrows.

```{R}

Plant_CCA_Chem <- cca(PlantSpecies ~ PlantChemistry$pH_level + SiO2 + Al2O3 +
Fe2O3 + CaO + MgO + MgO + Na2O + K2O + Cr2O3 + TiO2 + MnO + P2O5 + SrO + BaO + Ag + Al + 
As + B + Ba + Be + Bi + Ca + Cd + Co + Cr + Cu + Fe + Ga + Hg + K + La + Li + Mg + Mn + 
Mo + Na + Ni + P + Pb + S + Sb + Sc + Sr + Th + Ti + Tl + U + V + W + Zn + Akermanite + 
Albite + Aluminium.oxide.hydroxide + Anhydrite + Aragonite + Biotite + Birnessite + 
Calcite + Clinochlore + Cuspidine + Diaspore + Dickite + Gehlenite + Goethite + Haematite +
Illite + Kaolinite + Langite + Linnaeite + Magnesioferrite + Melilite + Merwinite + 
Microcline + Mullite + Muscovite + Orthoclase + Orthopyroxene + Periclase + Phengite + 
Pseudowollastonite + Quartz + Staurolite + Valentinite, data = PlantChemistry)

plot(Plant_CCA_Chem)

Plant_CCA_Chem1 <- cca(PlantSpecies ~ pH_level +SiO2 + Al2O3 + Fe2O3 + CaO + MgO + MgO +
Na2O + K2O + Cr2O3 + TiO2 + MnO + P2O5 + SrO + BaO + Ag + Al + As + B + Ba + Be + Bi + 
Ca + Cd + Co + Cr + Cu + Fe + Ga + Hg + K + La + Li + Mg + Mn + Mo + Na + Ni + P + Pb + S 
+ Sb + Sc + Sr + Th + Ti + Tl + U + V + W + Zn, data = PlantChemistry)

plot(Plant_CCA_Chem1)

Plant_CCA_Chem2 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + Fe2O3, data = 
PlantChemistry)

plot(Plant_CCA_Chem2)
summary(Plant_CCA_Chem2)
anova(Plant_CCA_Chem2)

```

#We now have an F statistic of 1.4889 and a p value of 0.001, which is our lowest p value
#so far. It is worth testing further because 1.4889 is not an especially high F statistic
#and the graph does not look ideal, especially as some of the variables have very short
#arrows in comparison to, say, Al2O3.

```{R}

Plant_CCA_Chem2.2 <-cca(PlantSpecies ~ Quartz + Gehlenite + Dickite +
Aluminium.oxide.hydroxide, data = PlantChemistry)

plot(Plant_CCA_Chem2.2)
summary(Plant_CCA_Chem2.2)
anova(Plant_CCA_Chem2.2)

```

#F statistic of 0.8, p value of 0.862.

```{R}

Plant_CCA_Chem3 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 +Fe2O3 + CaO, 
data = PlantChemistry)

plot(Plant_CCA_Chem3)
summary(Plant_CCA_Chem3)
anova(Plant_CCA_Chem3)

```

#F statistic of 1.4989 and p value of 0.001, still worth doing more tests.

```{R}

Plant_CCA_Chem4 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 +Fe2O3 + CaO + Cr,
data = PlantChemistry)

plot(Plant_CCA_Chem4)
summary(Plant_CCA_Chem4)
anova(Plant_CCA_Chem4)

```

#F statistic of 1.5057, p value of 0.01

```{R}

Plant_CCA_Chem5 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + Fe2O3 + CaO + Cr + Cr2O3,
data = PlantChemistry)
plot(Plant_CCA_Chem5)
summary(Plant_CCA_Chem5)
anova(Plant_CCA_Chem5)

```

#F statistic of 1.4131, p value of 0.01

```{R}

Plant_CCA_Chem6 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O, 
data = PlantChemistry)

plot(Plant_CCA_Chem6)
summary(Plant_CCA_Chem6)
anova(Plant_CCA_Chem6)

```

#F statistic of 1.5941, p value of 0.001

```{R}

Plant_CCA_Chem6.1 <- cca(PlantSpecies ~ pH_level + Al2O3 + CaO + Cr + K2O, 
data = PlantChemistry)

plot(Plant_CCA_Chem6.1)
summary(Plant_CCA_Chem6.1)
anova(Plant_CCA_Chem6.1)

```

#F statistic of 1.61, p value of 0.001

```{R}

Plant_CCA_Chem6.2 <- cca(PlantSpecies ~ pH_level + Al2O3 + CaO + Cr + K2O + Ba, 
data = PlantChemistry)
plot(Plant_CCA_Chem6.2)
summary(Plant_CCA_Chem6.2)
anova(Plant_CCA_Chem6.2)

```

#F statistic of 1.4809, p value of 0.001

```{R}

Plant_CCA_Chem6.3 <- cca(PlantSpecies ~ pH_level + Al2O3 + Al + CaO + Cr + K2O, 
data = PlantChemistry)

plot(Plant_CCA_Chem6.3)
summary(Plant_CCA_Chem6.3)
anova(Plant_CCA_Chem6.3)

```

#F statistic of 1.4901, p value of 0.001

```{R}

Plant_CCA_Chem6.4 <- cca(PlantSpecies ~ pH_level + Al2O3 + V + CaO + Cr + K2O, 
data = PlantChemistry)

plot(Plant_CCA_Chem6.4)
summary(Plant_CCA_Chem6.4)
anova(Plant_CCA_Chem6.4)

```

#F statistic of 1.5784, p value of 0.001

```{R}

Plant_CCA_Chem6.5 <- cca(PlantSpecies ~ pH_level + Al2O3 + Na2O + CaO + Cr + K2O, 
data = PlantChemistry)
plot(Plant_CCA_Chem6.5)
summary(Plant_CCA_Chem6.5)
anova(Plant_CCA_Chem6.5)

```

#F statistic of 1.5979, p value of 0.001

```{R}

Plant_CCA_Chem6.5 <- cca(PlantSpecies ~ pH_level + Al2O3 + Na2O + CaO, data = 
PlantChemistry)

plot(Plant_CCA_Chem6.5)
summary(Plant_CCA_Chem6.5)
anova(Plant_CCA_Chem6.5)

```

#F statistic of 1.6852, p value of 0.001

```{R}

Plant_CCA_Chem7 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2, 
data = PlantChemistry)

plot(Plant_CCA_Chem7)
summary(Plant_CCA_Chem7)
anova(Plant_CCA_Chem7)

```

#F statistic of 1.5948, p value of 0.001

```{R}

Plant_CCA_Chem8 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 +
Na2O, data = PlantChemistry)

plot(Plant_CCA_Chem8)
summary(Plant_CCA_Chem8)
anova(Plant_CCA_Chem8)

```

#F statistic of 1.5531, p value of 0.001

```{R}

Plant_CCA_Chem9 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 +
Na2O + BaO, data = PlantChemistry)

plot(Plant_CCA_Chem9)
summary(Plant_CCA_Chem9)
anova(Plant_CCA_Chem9)

```

#F statistic of 1.4908, p value of 0.001

```{R}

Plant_CCA_Chem10 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 + 
Na2O + BaO +Al, data = PlantChemistry)

plot(Plant_CCA_Chem10)
summary(Plant_CCA_Chem10)
anova(Plant_CCA_Chem10)

```

#F statistic of 1.4298, p value of 0.001

```{R}

Plant_CCA_Chem11 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 +
Na2O + BaO + Al + Kaolinite + Ag + Ba, data = PlantChemistry)
                        
plot(Plant_CCA_Chem11)
summary(Plant_CCA_Chem11)
anova(Plant_CCA_Chem11)

```

#F statistic of 1.3525, p value of 0.001

```{R}

Plant_CCA_Chem12 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 +
Na2O + BaO + Al + Kaolinite + Ba + Co + Fe + K + V, data = PlantChemistry)

plot(Plant_CCA_Chem12)  
summary(Plant_CCA_Chem12)
anova(Plant_CCA_Chem12)

```

#F statistic of 1.2642, p value of 0.001

```{R}

Plant_CCA_Chem13 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 +
Na2O + BaO + Al + Kaolinite + Ba + Co + Fe + K + V + Haematite, data = PlantChemistry)

plot(Plant_CCA_Chem13)  
summary(Plant_CCA_Chem13)
anova(Plant_CCA_Chem13)

```

#F statistic of 1.2345, p value of 0.002

```{R}

Plant_CCA_Chem14 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 +
Na2O + BaO + Al + Ba + Co + Fe + K + V + Haematite, data = PlantChemistry)

plot(Plant_CCA_Chem14)  
summary(Plant_CCA_Chem14)
anova(Plant_CCA_Chem14)

```

#F statistic of 1.2253, p value of 0.002

```{R}

Plant_CCA_Chem15 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3 + CaO + Cr + K2O + TiO2 + 
Na2O + BaO + Al + Ba + Co + Fe + K + V + Haematite + Langite, data = PlantChemistry)

plot(Plant_CCA_Chem15) 
summary(Plant_CCA_Chem15)
anova(Plant_CCA_Chem15)

```

#F statistic of 1.1708, p value of 0.021

```{R}

Plant_CCA_Chem16 <- cca(PlantSpecies ~ Al2O3 + Haematite + Co + Langite + Magnesioferrite 
+ Muscovite, data = PlantChemistry)

plot(Plant_CCA_Chem16) 
summary(Plant_CCA_Chem16) 
anova(Plant_CCA_Chem16) 

```

#F statistic of 1.0519, p value of 0.419

```{R}

Plant_CCA_Chem17 <- cca(PlantSpecies ~ pH_level + SiO2 + Al2O3, data = PlantChemistry)

plot(Plant_CCA_Chem17) 
summary(Plant_CCA_Chem17) 
anova(Plant_CCA_Chem17)

```

#F statistic of 1.7013, p value of 0.001

```{R}

Plant_CCA_Chem17.1 <- cca(PlantSpecies ~ pH_level + P2O5 +SiO2 + Al2O3, 
data = PlantChemistry)

plot(Plant_CCA_Chem17.1) 
summary(Plant_CCA_Chem17.1) 
anova(Plant_CCA_Chem17.1)

```

#F statistic of 1.6861, p value of 0.001

```{R}

Plant_CCA_Chem18 <- cca(PlantSpecies ~ Al + Ba + Co + Fe + V, data = PlantChemistry)

plot(Plant_CCA_Chem18) 
summary(Plant_CCA_Chem18) 
anova(Plant_CCA_Chem18) 

```

#F statistic of 1.35, P value of 0.02

```{R}

Plant_CCA_Chem19 <- cca(PlantSpecies ~ pH_level + Al2O3 + CaO + Cr + K2O + TiO2 + Na2O + 
BaO + Al + Ba + Co + V, data = PlantChemistry)

plot(Plant_CCA_Chem19) 
print(Plant_CCA_Chem19)
summary(Plant_CCA_Chem19)
anova(Plant_CCA_Chem19)

```

#F statistic of 1.3087, p value of 0.01

```{R}

Plant_CCA_Chem20 <- cca(PlantSpecies ~ pH_level + Al2O3 + CaO + Cr + K2O + TiO2 + Na2O + 
BaO + Al + Ba + Co + V, data = PlantChemistry)

plot(Plant_CCA_Chem20) 
print(Plant_CCA_Chem20)
summary(Plant_CCA_Chem20)
anova(Plant_CCA_Chem20)

```

#F statistic of 1.3087, p value of 0.001

```{R}

Plant_CCA_Chem21 <- cca(PlantSpecies ~ pH_level + Al2O3 + CaO + Cr + K2O + Na2O + BaO + 
Al + Ba + Co + V, data = PlantChemistry)

plot(Plant_CCA_Chem21) 
print(Plant_CCA_Chem21)
summary(Plant_CCA_Chem21)
anova(Plant_CCA_Chem21)

```

#F statistic of 1.3246, p value of 0.001

```{R}

Plant_CCA_Chem22 <- cca(PlantSpecies ~ pH_level + Al2O3 + CaO + Cr + K2O + Na2O + BaO + 
Al + Ba + Co + V + SiO2, data = PlantChemistry)

plot(Plant_CCA_Chem22) 
print(Plant_CCA_Chem22)
summary(Plant_CCA_Chem22)
anova(Plant_CCA_Chem22)

```

#F statistic of 1.3012, p value of 0.001

```{R}

Plant_CCA_Chem23 <- cca(PlantSpecies ~ pH_level + Al2O3 + CaO + Cr + K2O + Na2O + BaO +
Ba + Co + V + SiO2, data = PlantChemistry)

plot(Plant_CCA_Chem23) 
print(Plant_CCA_Chem23)
summary(Plant_CCA_Chem23)
anova(Plant_CCA_Chem23)

```

#F statistic of 1.3254, p value of 0.001

#Out of multiple CCAs with different combinations of different substrate variables,
#the one with the highest F statistic is Plant_CCA_Chem17, with an F statistic of 1.7013.
#However, this CCA, from a visual standpoint, does not seem to adequately show what
#is going on with the data and the arrow for SiO2 is very short in comparison with that
#of the other variables in the CCA. The most adequate CCA from a visual point of view is
#Plant_CCA_Chem20, with long arrows for all of the variables (at least in comparison
#with other CCAs) which account for most of the plant data shown. Unfortunately, the 
#F statistic for this CCA is 1.3087, which is much lower than than for Plant_CCA_Chem_17.
#A compromise would be a CCA that is visually similar to Plant_CCA_Chem20, but with a 
#higher F statistic. Plant_CCA_Chem23 would be the most appropriate example, with long
#arrows for all of the variables that also explain most of the data, and with a higher
#F statistic than Plant_CCA_Chem20, of 1.3254. This will be the CCA chosen to represent
#the influences of substrate chemistry on plant species presence on all six of the study
#sites.

#Now to construct a more visually appropriate graph for Plant_CCA_Chem23.

```{R}

options(max.print=1000000)

Plant_CCA_Chem23$CCA$v

```

#The "v values" show the positions of individual species on the graph, with the CCA1 value
#representing the x axis and the CCA2 value representing the y axis, in the case of the
#graph created in R.

```{R}

plot(Plant_CCA_Chem23, xlim = c(-5, 5), ylim = c(-5, 5)) 

#Increasing the xlim and ylim to give more room for writing on graph

points(x = 1.131232253, y = 0.22688025, pch = 15, col = "black")

#This point represents Anthyllis vulneraria

text('A. vulneraria', x = 4, y = 0.22, cex = 0.88, pos = 2, col = "black")

#Adding text to this point.

points(x = 0.893684489, y = -1.04080725, pch = 15, col = "black")

#This point represents Pilosella officinarum

Plant_CCA_Chem23 <- text('P. officinarum', x = 1.893684489, y = -1.5080725, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

Plant_CCA_Chem23 <- points(x = -1.40779422 , y =0.63388962, pch = 15, col = "black")

#This point represents Atrichum undulatum

Plant_CCA_Chem23 <- text('A. undulatum', x = -1.40779422, y = 0.63388962, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

Plant_CCA_Chem23 <- points(x = -1.31333973 , y = -2.30816549, pch = 15, col = "black")

#This point represents Agrostis spp.

Plant_CCA_Chem23 <- text('Agrostis spp.', x = -1.31333973, y = -2.30816549, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

Plant_CCA_Chem23 <- points(x = -1.453305146 , y = -2.79179610, pch = 15, col = "black")

#This point represents Dactylis glomerata

Plant_CCA_Chem23 <- text('D. glomerata', x = -1.453305146, y = -2.79179610, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

Plant_CCA_Chem23 <- points(x = 1.646889034 , y = 1.63654620, pch = 15, col = "black")

#This point represents Blackstonia perfoliata

Plant_CCA_Chem23 <- text('B. perfoliata', x = 4.3, y = 1.636, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

Plant_CCA_Chem23 <- points(x = -0.73858913 , y = 1.34862769, pch = 15, col = "black")

#This point represents Bryum capillare

Plant_CCA_Chem23 <- text('B. capillare', x = -0.73858913, y = 1.34862769, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

```

####Barrow Data####

```{R}

urlfile3  <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/BarrowPlantSpecies.csv'

BarrowPS <-read.csv(urlfile3)

urlfile4 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/BarrowPlantChemistry.csv'

BarrowPC <-read.csv(urlfile4)

head(BarrowPS)
head(BarrowPC)

sapply(BarrowPS, class)
sapply(BarrowPC, class)

rowSums(BarrowPS)
BarrowPSna <- na.omit(BarrowPS)

print(BarrowPS)

```

#Now to do some ANOSIM tests to assess any significant differences between plant species in #different chemical variables.

#anoBSiO2 <- anosim(BarrowPS, BarrowPC$SiO2, distance = "bray", permutations = 9999)

#When this ANOSIM is run, the error message: "there should be replicates within groups"
#comes up. This error message comes up for another substrate variables for the Barrow
#data. From now on, only variables that were tested successfully will be included.

```{R}

anoBK2O <- anosim(BarrowPS, BarrowPC$K2O, distance = "bray", permutations = 9999)

anoBK2O

```

#Not statistically significant, only significant results mentioned from now on.

```{R}

anoBCr2O3 <- anosim(BarrowPS, BarrowPC$Cr2O3, distance = "bray", permutations = 9999)

anoBCr2O3

anoBTiO2 <- anosim(BarrowPS, BarrowPC$TiO2, distance = "bray", permutations = 9999)

anoBTiO2

anoBMnO <- anosim(BarrowPS, BarrowPC$MnO, distance = "bray", permutations = 9999)

anoBMnO

anoBP2O5 <- anosim(BarrowPS, BarrowPC$P2O5, distance = "bray", permutations = 9999)

anoBP2O5

```

#R statistic of 0.6981 and p value of 0.0478 for P2O5.

```{R}

anoBSrO <- anosim(BarrowPS, BarrowPC$SrO, distance = "bray", permutations = 9999)

anoBSrO

anoBBaO <- anosim(BarrowPS, BarrowPC$BaO, distance = "bray", permutations = 9999)

anoBBaO

anoBAg <- anosim(BarrowPS, BarrowPC$Ag, distance = "bray", permutations = 9999)

anoBAg

anoBAs <- anosim(BarrowPS, BarrowPC$As, distance = "bray", permutations = 9999)

anoBAs

anoBB <- anosim(BarrowPS, BarrowPC$B, distance = "bray", permutations = 9999)

anoBB

anoBCa <- anosim(BarrowPS, BarrowPC$Ca, distance = "bray", permutations = 9999)

anoBCa

```

#High R statistic of 0.8519, but with a non-significant p value of 0.0947.

```{R}

anoBCd <- anosim(BarrowPS, BarrowPC$Cd, distance = "bray", permutations = 9999)

anoBCd

anoBCo <- anosim(BarrowPS, BarrowPC$Co, distance = "bray", permutations = 9999)

anoBCo

```

#R statistic of 0.5 and a close-to-significant p value of 0.0547.

```{R}

anoBCr <- anosim(BarrowPS, BarrowPC$Cr, distance = "bray", permutations = 9999)

anoBCr

anoBCu <- anosim(BarrowPS, BarrowPC$Cu, distance = "bray", permutations = 9999)

anoBCu

anoBK <- anosim(BarrowPS, BarrowPC$K, distance = "bray", permutations = 9999)

anoBK

anoBMn <- anosim(BarrowPS, BarrowPC$Mn, distance = "bray", permutations = 9999)

anoBMn

anoBNa <- anosim(BarrowPS, BarrowPC$Na, distance = "bray", permutations = 9999)

anoBNa

anoBNi <- anosim(BarrowPS, BarrowPC$Ni, distance = "bray", permutations = 9999)

anoBNi

anoBP <- anosim(BarrowPS, BarrowPC$P, distance = "bray", permutations = 9999)

anoBP

anoBS <- anosim(BarrowPS, BarrowPC$S, distance = "bray", permutations = 9999)

anoBS

anoBSb <- anosim(BarrowPS, BarrowPC$Sb, distance = "bray", permutations = 9999)

anoBSb

anoBSc <- anosim(BarrowPS, BarrowPC$Sc, distance = "bray", permutations = 9999)

anoBSc

anoBTi <- anosim(BarrowPS, BarrowPC$Ti, distance = "bray", permutations = 9999)

anoBTi

anoBV <- anosim(BarrowPS, BarrowPC$V, distance = "bray", permutations = 9999)

anoBV

```

#A high R statistic of 1, with a p value of 0.0164.

#With more than one of the variables showing significant differences in different Barrow
#samples, CCAs will be appropriate to demonstrate what is going on in the data.

```{R}

BarrowCCA <-cca(BarrowPSna, BarrowPC)

print(BarrowCCA)
summary(BarrowCCA)
plot(BarrowCCA)

```

#This CCA uses all of the plant data and substrate data. As before, substrate samples will
#be selected for CCAs that can be further examined using anova tests.

##Both 1.1 and 1.2 seem to be as good as each other##

```{R}

BarrowCCA1.1 <-cca(BarrowPSna ~ pH_level + CaO + MgO + K2O + MgO + Al2O3 + Cr2O3, 
data = BarrowPC)

print(BarrowCCA1.1)
summary(BarrowCCA1.1)
plot(BarrowCCA1.1)
anova(BarrowCCA1.1)

```

#F statistic of 1.6299 and p value of 0.001.

```{R}

BarrowCCA1.2 <-cca(BarrowPSna ~ pH_level + CaO + K2O + Al2O3 + Al + Pb + BaO + Calcite,
data = BarrowPC)

print(BarrowCCA1.2)
summary(BarrowCCA1.2)
anova(BarrowCCA1.2)
plot(BarrowCCA1.2)

```

#High F statistic of 2.2104 and p value of 0.01

##1.2 has a higher F statistic than 1.1 and they both have similar p values.

```{R}

BarrowCCA2 <- cca(BarrowPSna ~ Na2O + pH_level + MgO + CaO + Al2O3 + Cr2O3, data = BarrowPC)

print(BarrowCCA2)
summary(BarrowCCA2)
plot(BarrowCCA2)
anova(BarrowCCA2)

```

#To better visualise the BarrowCCA1.2 graph...

```{R}

BarrowCCA1.2$CCA$v

```

#The "v values" show the positions of individual species on the graph, with the CCA1 value
#representing the x axis and the CCA2 value representing the y axis, in the case of the
#graph created in R.

```{R}

plot(BarrowCCA1.2, choices = c(1,2), display = c("wa", "bp"), xlim = c(-4, 3),
     ylim = c(-3, 2))


#Increasing the xlim and ylim to give more room for writing on graph

points(x = -1.20539865, y = 0.165046334, pch = 15, col = "black")

#This point represents Anthyllis vulneraria

points(x = -1.58858229, y = -1.340460984, pch = 15, col = "black")

#This point represents Pilosella officinarum

points(x = -0.98711462, y = 0.577415697, pch = 15, col = "black")

#This point represents Briza media

points(x = -0.04783771, y = -0.911677253, pch = 15, col = "black")

#This point represents Plantago lanceolata

points(x = -2.53670128, y = -2.622753434, pch = 15, col = "black")

#This point represents Festuca ovina

points(x = 1.45267276, y = -1.725798864, pch = 15, col = "black")

#This point represents Blackstonia perfoliata

points(x = 0.17902934, y = 1.275510371, pch = 15, col = "black")

#This point represents Bromus hordeaceus

```

#Fallin Data#


```{R}

urlfile5 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-for-six-study-sites-for-PhD/PhD-files/FallinPlantSpecies.csv'

FallinPS <- read.csv(urlfile5,  header = TRUE, colClasses = c("numeric"))

urlfile6 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-for-six-study-sites-for-PhD/PhD-files/FallinPlantChemistry.csv'

FallinPC <-read.csv(urlfile6, header = TRUE, colClasses = c("numeric"))

head(FallinPS)
head(FallinPC)

sapply(FallinPS, class)
sapply(FallinPC, class)

rowSums(FallinPS)

```

#Time to do the ANOSIM tests for the Fallin data

#anoFSiO2 <- anosim(FallinPS, FallinPC$SiO2, distance = "bray", permutations = 9999)

#When this ANOSIM is run, the error message: "there should be replicates within groups"
#comes up. This error message comes up for another substrate variables for the
#data. From now on, only variables that were tested successfully will be included.

```{R}

anoFNa2O <- anosim(FallinPS, FallinPC$Na2O, distance = "bray", permutations = 9999)

anoFNa2O

anoFCr2O3 <- anosim(FallinPS, FallinPC$Cr2O3, distance = "bray", permutations = 9999)

anoFCr2O3

anoFSrO <- anosim(FallinPS, FallinPC$SrO, distance = "bray", permutations = 9999)

anoFSrO

anoFBaO <- anosim(FallinPS, FallinPC$BaO, distance = "bray", permutations = 9999)

anoFBaO

anoFAs <- anosim(FallinPS, FallinPC$As, distance = "bray", permutations = 9999)

anoFAs

anoFBa <- anosim(FallinPS, FallinPC$Ba, distance = "bray", permutations = 9999)

anoFBa

anoFBe <- anosim(FallinPS, FallinPC$Be, distance = "bray", permutations = 9999)

anoFBe

anoFCu <- anosim(FallinPS, FallinPC$Cu, distance = "bray", permutations = 9999)

anoFCu

anoFK <- anosim(FallinPS, FallinPC$K, distance = "bray", permutations = 9999)

anoFK

anoFNi <- anosim(FallinPS, FallinPC$Ni, distance = "bray", permutations = 9999)

anoFNi

anoFP <- anosim(FallinPS, FallinPC$P, distance = "bray", permutations = 9999)

anoFP

anoFS <- anosim(FallinPS, FallinPC$S, distance = "bray", permutations = 9999)

anoFS

anoFSc <- anosim(FallinPS, FallinPC$Sc, distance = "bray", permutations = 9999)

anoFSc

anoFSr <- anosim(FallinPS, FallinPC$Sr, distance = "bray", permutations = 9999)

anoFSr

```

#High R statistic of 1, but with a non-significant p value of 0.1

#None of the ANOSIM tests led to stastistically significant results. Because of this,
#CCAs might not be entirely appropriate to represent the data visually.
#Both CCA and NMDS analyses will be utilised to visualise the plant data.

```{R}

FallinNMDS <- metaMDS(FallinPS, noshare = TRUE, autotransform = FALSE, trymax = 500)

plot(FallinNMDS)

FallinNMDS

#This simple NMDS shows communities represented as circles and species represented as 
#red crosses.

plot(FallinNMDS, "sites")   # Produces distance 
plot(FallinNMDS, "species", xlim = c(-0.5, 0.5), ylim = c(-1.5, 1.0))
orditorp(FallinNMDS, "species")

#We are only seeing some of the Fallin species in the graph produced by the function
#"orditorp", but this still gives an idea of how different species are differently and/or
#similarly distributed in different communities on Fallin Bing.

#CCA analyses for Fallin data... It might be easier to visualise what is going on
#using an appropriate CCA, especially with substrate variables being taken into account
#in the CCA.

```

#CCA analyses for Fallin data...#

```{R}

FallinCCA <- cca(FallinPS ~ pH_level + SiO2 + Al2O3 +
                   Fe2O3 + CaO + MgO + MgO + Na2O + K2O + Cr2O3 + TiO2 + MnO + P2O5 + SrO + BaO + Ag + Al + As + B + Ba + Be + Bi + Ca + Cd + Co + Cr + Cu + Fe + Ga + Hg + K + La + Li + Mg + Mn + Mo + Na + Ni + P + Pb + S + Sb + Sc + Sr + Th + Ti + Tl + U + V + W + Zn + Akermanite + Albite + Aluminium.oxide.hydroxide + Anhydrite + Aragonite + Biotite + Birnessite + Calcite + Clinochlore + Cuspidine + Diaspore + Dickite + Gehlenite + Goethite + Haematite + Illite + Kaolinite + Langite + Linnaeite + Magnesioferrite + Melilite + Merwinite + Microcline + Mullite + Muscovite + Orthoclase + Orthopyroxene + Periclase + Phengite + Pseudowollastonite + Quartz + Staurolite + Valentinite, data = FallinPC)

print(FallinCCA)
plot(FallinCCA)

FallinCCA1 <- cca(FallinPS ~ pH_level + SiO2 + Al2O3 +Fe2O3 + CaO + MgO + MgO + Na2O + K2O + Cr2O3 + TiO2 + MnO + P2O5 + SrO + BaO + Ag + Al + As + B + Ba + Be + Bi + Ca + Cd + Co + Cr + Cu + Fe + Ga + Hg + K + La + Li + Mg + Mn + Mo + Na + Ni + P + Pb + S + Sb + Sc + Sr + Th + Ti + Tl + U + V + W + Zn, data= FallinPC)

print(FallinCCA1)
plot(FallinCCA1)

FallinCCA2 <- cca(FallinPS ~ pH_level + SiO2 + Al2O3 + Fe2O3, data= FallinPC)

print(FallinCCA2)
plot(FallinCCA2)

FallinCCA3 <- cca(FallinPS ~ pH_level + SiO2 + Al2O3, data= FallinPC)

print(FallinCCA3)
plot(FallinCCA3)
anova(FallinCCA3)

```

#F statistic of 0.8656, p value of 0.475

```{R}

FallinCCA4 <- cca(FallinPS ~ pH_level + SiO2 + CaO, data= FallinPC)

print(FallinCCA4)
plot(FallinCCA4)
anova(FallinCCA4)

```

#F statistic of 1.1035, p value of 0.3333

```{R}

FallinCCA5 <- cca(FallinPS ~ pH_level + SiO2 + MgO, data= FallinPC)

print(FallinCCA5)
plot(FallinCCA5)
anova(FallinCCA5)

```

#F statistic of 1.5285, p value of 0.2

```{R}

FallinCCA6 <- cca(FallinPS ~ Al2O3 + SiO2 + MgO, data= FallinPC)

print(FallinCCA6)
plot(FallinCCA6)
anova(FallinCCA6)

```

#F statistic of 1.298, p value of 0.2

```{R}

FallinCCA7 <- cca(FallinPS ~ Na2O + Al2O3 + MgO, data= FallinPC)

print(FallinCCA7)
plot(FallinCCA7)
anova(FallinCCA7)

```

#F statistic of 1.4846, p value of 0.1583

```{R}

FallinCCA8 <- cca(FallinPS ~ K2O + Al + MgO, data= FallinPC)

print(FallinCCA8)
plot(FallinCCA8)
anova(FallinCCA8)

```

#F statistic of 1.6086, p value of 0.1333

```{R}

FallinCCA9 <- cca(FallinPS ~ K2O + Cr2O3 + MgO, data= FallinPC)

print(FallinCCA9)
plot(FallinCCA9)
anova(FallinCCA9)

```

#F statistic of 1.742, p value of 0.09167

```{R}

FallinCCA10 <- cca(FallinPS ~ K2O + Cu + MgO, data= FallinPC)

print(FallinCCA10)
plot(FallinCCA10)
anova(FallinCCA10)

```

#F statistic of 1.7608, p value of 0.075

```{R}

FallinCCA11 <- cca(FallinPS ~ K2O + Pb + MgO, data= FallinPC)

print(FallinCCA11)
plot(FallinCCA11)
anova(FallinCCA11)

```

#F statistic of 1.7081, p value of 0.08333

```{R}

FallinCCA12 <- cca(FallinPS ~ K2O + Sr + MgO, data= FallinPC)

print(FallinCCA12)
plot(FallinCCA12)
anova(FallinCCA12)

```

#F statistic of 1.7081, p value of 0.08333

```{R}

FallinCCA13 <- cca(FallinPS ~ K2O + Zn + MgO, data= FallinPC)

print(FallinCCA13)
plot(FallinCCA13)
anova(FallinCCA13)

```

#F statistic of 1.7081, p value of 0.08333

```{R}

FallinCCA14 <- cca(FallinPS ~ K2O + Dickite + MgO, data= FallinPC)

print(FallinCCA14)
plot(FallinCCA14)
anova(FallinCCA14)

```

#F statistic of 1.7081, p value of 0.08333

#Though several combinations of data were tried, none of the CCAs generated for the Fallin #data generated significant values in the relevant anova tests. This would indicate that #the NMDS generated previously better represents the data and the #differences between both #communities and species.

###Addiewell###

```{R}

urlfile7 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/AddiewellPlantSpecies.csv'

AddiewellPS <- read.csv(urlfile7,  header = TRUE, colClasses = c("numeric"))

urlfile8 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/AddiewellPlantChemistry.csv'

AddiewellPC <-read.csv(urlfile8, header = TRUE, 
                    colClasses = c("numeric"))

head(AddiewellPS)
head(AddiewellPC)

```

#Now to run some ANOSIMS...

#anoASiO2 <- anosim(AddiewellPS, AddiewellPC$SiO2, distance = "bray", permutations = 9999)

#When this ANOSIM is run, the error message: "there should be replicates within groups"
#comes up. This error message comes up for another substrate variables for the
#data. From now on, only variables that were tested successfully will be included.

```{R}

anoANa2O <- anosim(AddiewellPS, AddiewellPC$Na2O, distance = "bray", permutations = 9999)

anoANa2O

```

#High R statistic, but with a non-significant p value of 0.2

```{R}

anoACr2O3 <- anosim(AddiewellPS, AddiewellPC$Cr2O3, distance = "bray", permutations = 9999)

anoACr2O3

anoAMnO <- anosim(AddiewellPS, AddiewellPC$MnO, distance = "bray", permutations = 9999)

anoAMnO

anoASrO <- anosim(AddiewellPS, AddiewellPC$SrO, distance = "bray", permutations = 9999)

anoASrO

anoABaO <- anosim(AddiewellPS, AddiewellPC$BaO, distance = "bray", permutations = 9999)

anoABaO

anoAAg <- anosim(AddiewellPS, AddiewellPC$Ag, distance = "bray", permutations = 9999)

anoAAg

anoAAs <- anosim(AddiewellPS, AddiewellPC$As, distance = "bray", permutations = 9999)

anoAAs

anoABa <- anosim(AddiewellPS, AddiewellPC$Ba, distance = "bray", permutations = 9999)

anoABa

anoABe <- anosim(AddiewellPS, AddiewellPC$Be, distance = "bray", permutations = 9999)

anoABe

anoACd <- anosim(AddiewellPS, AddiewellPC$Cd, distance = "bray", permutations = 9999)

anoACd

anoACo <- anosim(AddiewellPS, AddiewellPC$Co, distance = "bray", permutations = 9999)

anoACo

anoACr <- anosim(AddiewellPS, AddiewellPC$Cr, distance = "bray", permutations = 9999)

anoACr

anoAMg <- anosim(AddiewellPS, AddiewellPC$Mg, distance = "bray", permutations = 9999)

anoAMg

anoAMn <- anosim(AddiewellPS, AddiewellPC$Mn, distance = "bray", permutations = 9999)

anoAMn

anoAMo <- anosim(AddiewellPS, AddiewellPC$Mo, distance = "bray", permutations = 9999)

anoAMo

anoANa <- anosim(AddiewellPS, AddiewellPC$Na, distance = "bray", permutations = 9999)

anoANa

anoASb <- anosim(AddiewellPS, AddiewellPC$Sb, distance = "bray", permutations = 9999)

anoASb

anoASc <- anosim(AddiewellPS, AddiewellPC$Sc, distance = "bray", permutations = 9999)

anoASc

anoATi <- anosim(AddiewellPS, AddiewellPC$Ti, distance = "bray", permutations = 9999)

anoATi

```

#None of the ANOSIM tests led to stastistically significant results. Because of this,
#CCAs might not be entirely appropriate to represent the data visually.
#NMDS analyses will be utilised instead to visualise the plant data.

```{R}

AddiewellNMDS <- metaMDS(AddiewellPS, noshare = TRUE, autotransform = FALSE, trymax = 500)

plot(AddiewellNMDS)

```

#This is a simple NMDS plot, with the different plant communities as circles and the
#red crosses as species.

```{R}

AddiewellNMDS

plot(AddiewellNMDS, "sites")   # Produces distance 
plot(AddiewellNMDS, "species", xlim = c(-0.5, 0.5), ylim = c(-1.5, 1.0))
orditorp(AddiewellNMDS, "species")

```

#The orditorp function provides some of the plant species on the site on the graph. 
#Most of the species are grouped fairly close together, apart from species such as
#Pseudoscleropodium purum. It will be interesting to look at CCAs of the plant and
#substrate data at Addiewell Bing, to better visualise the relationship between plants
#and substrate.

#Now for some CCAS...

```

```{R}

AddiewellCCA <- cca(AddiewellPS, AddiewellPC)

print(AddiewellCCA)
plot(AddiewellCCA)
summary(AddiewellCCA)

```

```{R}

AddiewellCCA2 <- cca(AddiewellPS ~ Co + Pb + S + As, data = AddiewellPC)

print(AddiewellCCA2)
plot(AddiewellCCA2)
summary(AddiewellCCA2)

```

```{R}

AddiewellCCA3 <- cca(AddiewellPS ~ V + Pb + S + As, data = AddiewellPC)

print(AddiewellCCA3)
plot(AddiewellCCA3)
summary(AddiewellCCA3)

```

```{R}

AddiewellCCA4 <- cca(AddiewellPS ~ Pb + S + As, data = AddiewellPC)

print(AddiewellCCA4)
plot(AddiewellCCA4)
summary(AddiewellCCA4)
anova(AddiewellCCA4)

```

#F statistic of 1.1966 and p value of 0.35

```{R}

AddiewellCCA5 <- cca(AddiewellPS ~ pH_level + Al2O3 + Fe2O3, data = AddiewellPC)

print(AddiewellCCA5)
plot(AddiewellCCA5)
summary(AddiewellCCA5)
anova(AddiewellCCA5)

```

#F statstic of 1.5298 and p value of 0.15.

```{R}

AddiewellCCA6 <- cca(AddiewellPS ~ Pb  + Al2O3 + Fe2O3, data = AddiewellPC)

print(AddiewellCCA6)
plot(AddiewellCCA6)
summary(AddiewellCCA6)
anova(AddiewellCCA6)

```

#F statistic of 0.6767 and p value of 0.8667.

```{R}

AddiewellCCA7 <- cca(AddiewellPS ~ V + S + As, data = AddiewellPC)

print(AddiewellCCA7)
plot(AddiewellCCA7)
summary(AddiewellCCA7)
anova(AddiewellCCA7)

```

#F statistic of 2.6926 and p value of 0.008333.

```{R}

AddiewellCCA8 <- cca(AddiewellPS ~ V + S + Co, data = AddiewellPC)

print(AddiewellCCA8)
plot(AddiewellCCA8)
summary(AddiewellCCA8)
anova(AddiewellCCA8)

```

#F statistic of 2.6399 and p value of 0.008333.

```{R}

AddiewellCCA9 <- cca(AddiewellPS ~ V + As + Co, data = AddiewellPC)

print(AddiewellCCA9)
plot(AddiewellCCA9)
summary(AddiewellCCA9)
anova(AddiewellCCA9)

```

#F statistic of 1.789 and p value of 0.3083.

#Out of the multiple CCA tests done so far, AddiewellCCA8 has the highest F statistic, of
#2.6399 and a low p value of 0.008. 

#Making an improved plot for AddiewellCCA8...

#Now to construct a more visually appropriate graph

```{R}

options(max.print=1000000)

AddiewellCCA8$CCA$v

#The "v values" show the positions of individual species on the graph, with the CCA1 value
#representing the x axis and the CCA2 value representing the y axis, in the case of the
#graph created in R.

plot(AddiewellCCA8, xlim = c(-5, 5), ylim = c(-5, 5)) 

#Increasing the xlim and ylim to give more room for writing on graph

plot(AddiewellCCA8, choices = c(1,2), display = c("wa", "bp"), xlim = c(-4, 3),
     ylim = c(-3, 2))

#Increasing the xlim and ylim to give more room for writing on graph

points(x = -0.7489654, y = 1.800593063, pch = 15, col = "black")

#This point represents Pseudoscleropodium purum

text('P. purum', x = -0.7489654, y = 1.800593063, cex = 0.88, pos = 2, col = "black")

#Adding text to this point.

points(x = 2.9994831, y = 0.389478023, pch = 15, col = "black")

#This point represents Aphanes arvensis

text('A. arvensis', x = 2.9994831, y = 0.389478023, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = -0.3581164 , y =-2.030353578, pch = 15, col = "black")

#This point represents Atrichum undulatum

text('A. undulatum', x = -0.3581164, y = -2.030353578, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = -0.1573074 , y = 0.006104544, pch = 15, col = "black")

#This point represents Viola riviniana

text('V. riviniana', x = -0.1573074, y = 0.006104544, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = -0.7489654 , y = 1.800593063, pch = 15, col = "black")

#This point represents Dicranum scoparium.

text('D. scoparium', x = -0.7489654, y = 1.800593063, cex = 0.88, pos = 2, col = "black")

#Adding text to this point, note that this and P. purum are in the same place.

```

#Penicuik Data#

```{R}

urlfile9 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/PenicuikPlantSpecies.csv'

PenicuikPS <- read.csv(urlfile9,  header = TRUE, colClasses = c("numeric"))

urlfile10 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/PenicuikPlantChemistry.csv'

PenicuikPC <-read.csv(urlfile10, header = TRUE, colClasses = c("numeric"))

head(PenicuikPS)
head(PenicuikPC)

rowSums(PenicuikPS)

```

#Now for some ANOSIMs...

#anoPSiO2 <- anosim(PenicuikPS, PenicuikPC$SiO2, distance = "bray", permutations = 9999)

#When this ANOSIM is run, the error message: "there should be replicates within groups"
#comes up. This error message comes up for another substrate variables for the Barrow
#data. From now on, only variables that were tested successfully will be included.

```{R}

anoPCr2O3 <- anosim(PenicuikPS, PenicuikPC$Cr2O3, distance = "bray", permutations = 9999)

anoPCr2O3

anoPSrO <- anosim(PenicuikPS, PenicuikPC$SrO, distance = "bray", permutations = 9999)

anoPSrO

#This has a high R statistic of 1, but with a non-significant p value of 0.2

anoPAg <- anosim(PenicuikPS, PenicuikPC$Ag, distance = "bray", permutations = 9999)

anoPAg

anoPAs <- anosim(PenicuikPS, PenicuikPC$As, distance = "bray", permutations = 9999)

anoPAs

anoPCd <- anosim(PenicuikPS, PenicuikPC$Cd, distance = "bray", permutations = 9999)

anoPCd

anoPCo <- anosim(PenicuikPS, PenicuikPC$Co, distance = "bray", permutations = 9999)

anoPCo

anoPFe <- anosim(PenicuikPS, PenicuikPC$Fe, distance = "bray", permutations = 9999)

anoPFe

#This has a high R statistic of 1, but with a non-significant p value of 0.1

anoPNa <- anosim(PenicuikPS, PenicuikPC$Na, distance = "bray", permutations = 9999)

anoPNa

anoPPb <- anosim(PenicuikPS, PenicuikPC$Pb, distance = "bray", permutations = 9999)

anoPPb

anoPSc <- anosim(PenicuikPS, PenicuikPC$Sc, distance = "bray", permutations = 9999)

anoPSc

anoPTi <- anosim(PenicuikPS, PenicuikPC$Ti, distance = "bray", permutations = 9999)

anoPTi

```

#None of the ANOSIM tests led to stastistically significant results. Because of this,
#CCAs might not be entirely appropriate to represent the data visually.
#NMDS analyses will be utilised instead to visualise the plant data.

```{R}

PenicuikNMDS <- metaMDS(PenicuikPS)

plot(PenicuikNMDS)

#As in the previous NMDS plots, plant species are represented by red crosses, while
#plant communities are represented by circles.

PenicuikNMDS

plot(PenicuikNMDS, "sites")   # Produces distance 
plot(PenicuikNMDS, "species", xlim = c(-0.2, 0.5), ylim = c(-0.4, 0.8))
orditorp(PenicuikNMDS, "species")

#The ordiplot function here shows some differences between species on South Bank Wood in 
#Penicuik. U. dioica, for example, plots separately from all of the other species, although
#not all of the species on-site are represented on this plot.
#It might give further context to look at a CCA of this site as well, especially to look
#at plants and substrate.

```

```{R}

PenciuikCCA <- cca(PenicuikPS, PenicuikPC)

print(PenciuikCCA)
plot(PenciuikCCA)
summary(PenciuikCCA)

```

```{R}

PenicuikCCA2 <- cca(PenicuikPS ~ Al2O3 + pH_level + Fe2O3 + SiO2, data = PenicuikPC)

print(PenicuikCCA2)
plot(PenicuikCCA2)
summary(PenicuikCCA2)

```

```{R}

PenicuikCCA3 <- cca(PenicuikPS ~ Al2O3 + pH_level + Fe2O3, data = PenicuikPC)

print(PenicuikCCA3)
plot(PenicuikCCA3)
summary(PenicuikCCA3)
anova(PenicuikCCA3)

```

#An F statistic of 1.6284 and a low p value of 0.01667.

```{R}

PenicuikCCA4 <- cca(PenicuikPS ~ Al2O3 + SrO + Fe2O3, data = PenicuikPC)

print(PenicuikCCA4)
plot(PenicuikCCA4)
summary(PenicuikCCA4)
anova(PenicuikCCA4)

```

#An F statistic of 1.1854 and a p value of 0.1667.

```{R}

PenicuikCCA5 <- cca(PenicuikPS ~ pH_level + SrO + Fe2O3, data = PenicuikPC)

print(PenicuikCCA5)
plot(PenicuikCCA5)
summary(PenicuikCCA5)
anova(PenicuikCCA5)

```

#An F statistic of 1.5566 and a p value of 0.01667.

```{R}

PenicuikCCA6 <- cca(PenicuikPS ~ pH_level + SrO + Al2O3, data = PenicuikPC)

print(PenicuikCCA6)
plot(PenicuikCCA6)
summary(PenicuikCCA6)
anova(PenicuikCCA6)

```

#An F statistic of 1.5467 and a p value of 0.01667.

```{R}

PenicuikCCA7 <- cca(PenicuikPS ~ MgO + SrO + As, data = PenicuikPC)

print(PenicuikCCA7)
plot(PenicuikCCA7)
summary(PenicuikCCA7)
anova(PenicuikCCA7)

```

#An F statistic of 0.8787 and a p value of 0.4833.

```{R}

PenicuikCCA8 <- cca(PenicuikPS ~ pH_level + SrO + As, data = PenicuikPC)

print(PenicuikCCA8)
plot(PenicuikCCA8)
summary(PenicuikCCA8)
anova(PenicuikCCA8)

```

#An F statistic of 1.6757 and a p value of 0.008333.

```{R}

PenicuikCCA9 <- cca(PenicuikPS ~ Al2O3 + SrO + As, data = PenicuikPC)

print(PenicuikCCA9)
plot(PenicuikCCA9)
summary(PenicuikCCA9)
anova(PenicuikCCA9)

```

#An F statistic of 1.5945 and a p value of 0.01667.

```{R}

PenicuikCCA10 <- cca(PenicuikPS ~ pH_level + SrO + Co, data = PenicuikPC)

print(PenicuikCCA10)
plot(PenicuikCCA10)
summary(PenicuikCCA10)
anova(PenicuikCCA10)

```

#An F statistic of 1.8171 and a p value of 0.008333.

```{R}

PenicuikCCA11 <- cca(PenicuikPS ~ pH_level + SrO + Pb, data = PenicuikPC)

print(PenicuikCCA11)
plot(PenicuikCCA11)
summary(PenicuikCCA11)
anova(PenicuikCCA11)

```

#An F statistic of 1.5834 and a p value of 0.01667.

```{R}

PenicuikCCA12 <- cca(PenicuikPS ~ pH_level + SrO + V, data = PenicuikPC)

print(PenicuikCCA12)
plot(PenicuikCCA12)
summary(PenicuikCCA12)
anova(PenicuikCCA12)

```

#An F statistic of 1.569 and a p value of 0.01667.

```{R}

PenicuikCCA13 <- cca(PenicuikPS ~ pH_level + SrO, data = PenicuikPC)

print(PenicuikCCA13)
plot(PenicuikCCA13)
summary(PenicuikCCA13)
anova(PenicuikCCA13)

```

#An F statistic of 1.7369 and a p value of 0.01667.

```{R}

PenicuikCCA14 <- cca(PenicuikPS ~ pH_level + SrO + Sr, data = PenicuikPC)

print(PenicuikCCA14)
plot(PenicuikCCA14)
summary(PenicuikCCA14)
anova(PenicuikCCA14)

```

#An F statistic of 1.3011 and a p value of 0.1.

```{R}

PenicuikCCA15 <- cca(PenicuikPS ~ pH_level + SrO + BaO, data = PenicuikPC)

print(PenicuikCCA15)
plot(PenicuikCCA15)
summary(PenicuikCCA15)
anova(PenicuikCCA15)

```

#An F statistic of 1.8107 and a p value of 0.008333.

#After doing multiple CCAs, the one with the highest F statistic and lowest p value is 
#PenicuikCCA10. However, the plot for this has a very short arrow for Co, which indicates
#that Co may not be such an important variable for the CCA. PenicuikCCA15, meanwhile, has
#a slightly lower F statistic of 1.8107, the same p value of 0.00833 and BaO has a longer
#arrow. The plot for PenicuikCCA15 can be improved to better show the relationships
#between substrate and plant species.

```

```{R}

options(max.print=1000000)

PenicuikCCA15$CCA$v

#The "v values" show the positions of individual species on the graph, with the CCA1 value
#representing the x axis and the CCA2 value representing the y axis, in the case of the
#graph created in R.

plot(PenicuikCCA15, xlim = c(-5, 5), ylim = c(-5, 5)) 

#Increasing the xlim and ylim to give more room for writing on graph

plot(PenicuikCCA15, choices = c(1,2), display = c("wa", "bp"), xlim = c(-4, 3),
     ylim = c(-3, 2))

#Increasing the xlim and ylim to give more room for writing on graph

points(x = -0.3287172, y = -1.564160e+00, pch = 15, col = "black")

#This point represents Glechoma hederacea

text('G. hederacea', x = -0.3287172, y = -1.564160e+00, cex = 0.88, pos = 2, col = "black")

#Adding text to this point.

points(x = -0.3287172 , y = 1.422548e+00, pch = 15, col = "black")

#This point represents Epilobium montanum

text('E. montanum', x = -0.3287172 , y = 1.422548e+00, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = 3.0421284 , y = 1.075808e-15, pch = 15, col = "black")

#This point represents Heracleum sphondylium

text('H. sphondylium', x = 3.0421284, y = 1.075808e-15, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = -0.3287172 , y = 6.628426e-01, pch = 15, col = "black")

#This point represents Angelica sylvestris

text('A. sylvestris', x = -0.3287172, y = 6.628426e-01, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = 3.0421284, y = 6.083101e-15, pch = 15, col = "black")

```

##Carnforth Data

```{R}

urlfile11 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/CarnforthPlantSpecies.csv'

CarnforthPS <- read.csv(urlfile11, header = TRUE, colClasses = c("numeric"))

urlfile12 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/CarnforthPlantChemistry.csv'

CarnforthPC <-read.csv(urlfile12, header = TRUE, colClasses = c("numeric"))

head(CarnforthPS)
head(CarnforthPC)

rowSums(CarnforthPS)

```

#Now for some ANOSIMs...

#anoCSiO2 <- anosim(CarnforthPS, CarnforthPC$SiO2, distance = "bray", permutations = 9999)

#When this ANOSIM is run, the error message: "there should be replicates within groups"
#comes up. This error message comes up for another substrate variables for the Barrow
#data. From now on, only variables that were tested successfully will be included.

```{R}

anoCMgO <- anosim(CarnforthPS, CarnforthPC$MgO, distance = "bray", permutations = 9999)

anoCMgO

anoCCr2O3 <- anosim(CarnforthPS, CarnforthPC$Cr2O3, distance = "bray", permutations = 9999)

anoCCr2O3

anoCP2O5 <- anosim(CarnforthPS, CarnforthPC$P2O5, distance = "bray", permutations = 9999)

anoCP2O5

anoCSrO <- anosim(CarnforthPS, CarnforthPC$SrO, distance = "bray", permutations = 9999)

anoCSrO

anoCBaO <- anosim(CarnforthPS, CarnforthPC$BaO, distance = "bray", permutations = 9999)

anoCBaO

anoCAg <- anosim(CarnforthPS, CarnforthPC$Ag, distance = "bray", permutations = 9999)

anoCAg

anoCAl <- anosim(CarnforthPS, CarnforthPC$Al, distance = "bray", permutations = 9999)

anoCAl

anoCAs <- anosim(CarnforthPS, CarnforthPC$As, distance = "bray", permutations = 9999)

anoCAs

anoCB <- anosim(CarnforthPS, CarnforthPC$B, distance = "bray", permutations = 9999)

anoCB

anoCBa <- anosim(CarnforthPS, CarnforthPC$Ba, distance = "bray", permutations = 9999)

anoCBa

anoCBe <- anosim(CarnforthPS, CarnforthPC$Be, distance = "bray", permutations = 9999)

anoCBe

anoCCa <- anosim(CarnforthPS, CarnforthPC$Ca, distance = "bray", permutations = 9999)

anoCCa

anoCCd <- anosim(CarnforthPS, CarnforthPC$Cd, distance = "bray", permutations = 9999)

anoCCd

anoCCo <- anosim(CarnforthPS, CarnforthPC$Co, distance = "bray", permutations = 9999)

anoCCo

anoCCr <- anosim(CarnforthPS, CarnforthPC$Cr, distance = "bray", permutations = 9999)

anoCCr

anoCCu <- anosim(CarnforthPS, CarnforthPC$Cu, distance = "bray", permutations = 9999)

anoCCu

anoCFe <- anosim(CarnforthPS, CarnforthPC$Fe, distance = "bray", permutations = 9999)

anoCFe

anoCK <- anosim(CarnforthPS, CarnforthPC$K, distance = "bray", permutations = 9999)

anoCK

anoCMg <- anosim(CarnforthPS, CarnforthPC$Mg, distance = "bray", permutations = 9999)

anoCMg

anoCMn <- anosim(CarnforthPS, CarnforthPC$Mn, distance = "bray", permutations = 9999)

anoCMn

anoCMo <- anosim(CarnforthPS, CarnforthPC$Mo, distance = "bray", permutations = 9999)

anoCMo

anoCNa <- anosim(CarnforthPS, CarnforthPC$Na, distance = "bray", permutations = 9999)

anoCNa

anoCNi <- anosim(CarnforthPS, CarnforthPC$Ni, distance = "bray", permutations = 9999)

anoCNi

anoCP <- anosim(CarnforthPS, CarnforthPC$P, distance = "bray", permutations = 9999)

anoCP

anoCPb <- anosim(CarnforthPS, CarnforthPC$Pb, distance = "bray", permutations = 9999)

anoCPb

anoCS <- anosim(CarnforthPS, CarnforthPC$S, distance = "bray", permutations = 9999)

anoCS

anoCSb <- anosim(CarnforthPS, CarnforthPC$Sb, distance = "bray", permutations = 9999)

anoCSb

anoCSc <- anosim(CarnforthPS, CarnforthPC$Sc, distance = "bray", permutations = 9999)

anoCSc

anoCSr <- anosim(CarnforthPS, CarnforthPC$Sr, distance = "bray", permutations = 9999)

anoCSr

anoCTi <- anosim(CarnforthPS, CarnforthPC$Ti, distance = "bray", permutations = 9999)

anoCTi

anoCV <- anosim(CarnforthPS, CarnforthPC$V, distance = "bray", permutations = 9999)

anoCV

anoCZn <- anosim(CarnforthPS, CarnforthPC$Zn, distance = "bray", permutations = 9999)

anoCZn

#None of the ANOSIM tests led to stastistically significant results. Because of this,
#CCAs might not be entirely appropriate to represent the data visually.
#NMDS analyses will be utilised to visualise the plant data.

```

```{R}

CarnforthNMDS <- metaMDS(CarnforthPS)

plot(CarnforthNMDS)

```

#As in the other NMDS plots, species are represented by red crosses and communities are 
#represented by circles.

```{R}

CarnforthNMDS

plot(CarnforthNMDS, "sites")   # Produces distance 
plot(CarnforthNMDS, "species")
orditorp(CarnforthNMDS, "species")

```

#What is interesting about this NMDS is that most of the species are separated out, with 
#very little clustering or 'clumping'. This contrasts greatly with the NMDS plots
#for Fallin Bing, Addiewell Bing and South Bank Wood (Penicuik). It might still be
#useful to look at a CCA for Carnforth as well...

```{R}

CarnforthCCA <- cca(CarnforthPS, CarnforthPC)
print(CarnforthCCA)
plot(CarnforthCCA)

CarnforthCCA1 <- cca(CarnforthPS ~ Na2O + Co + SrO + Al2O3 + Calcite,
                     data = CarnforthPC)

print(CarnforthCCA1)
plot(CarnforthCCA1)
anova(CarnforthCCA1)

```

##An F statistic of 1.4478 and a low p value of 0.005.

```{R}

CarnforthCCA2 <- cca(CarnforthPS ~ Na2O + Co +SrO + Al2O3 + Calcite + MgO,
                     data = CarnforthPC)

print(CarnforthCCA2)
plot(CarnforthCCA2)
anova(CarnforthCCA2)

```

##An F statistic of 1.6947 and a low p value of 0.001.

```{R}

CarnforthCCA3 <- cca(CarnforthPS ~ Na2O + Co + P + Al2O3, data = CarnforthPC)
print(CarnforthCCA3)
plot(CarnforthCCA3)
anova(CarnforthCCA3)

```

#An F statistic of 1.166 and a p value of 0.115.

```{R}

CarnforthCCA4 <- cca(CarnforthPS ~ pH_level + Co +SrO + Al2O3 + Calcite + MgO,
                     data = CarnforthPC)

print(CarnforthCCA4)
plot(CarnforthCCA4)
anova(CarnforthCCA4)

```

#An F statistic of 1.3792 and a p value of 0.023.

```{R}

CarnforthCCA5 <- cca(CarnforthPS ~ pH_level + Co + As + Al2O3 + Calcite + MgO,
                     data = CarnforthPC)

print(CarnforthCCA5)
plot(CarnforthCCA5)
anova(CarnforthCCA5)

```

#An F statistic of 1.243 and a p value of 0.076.

```{R}

CarnforthCCA6 <- cca(CarnforthPS ~ Na2O + Co +SrO + Al2O3 + Calcite + V,
                     data = CarnforthPC)

print(CarnforthCCA6)
plot(CarnforthCCA6)
anova(CarnforthCCA6)

```

#An F statistic of 1.2818 and a p value of 0.035.

```{R}

CarnforthCCA7 <- cca(CarnforthPS ~ Na2O + Co +SrO + Al2O3 + Ag + MgO,
                     data = CarnforthPC)

print(CarnforthCCA7)
plot(CarnforthCCA7)
anova(CarnforthCCA7)

```

#An F statistic of 1.6045 and a p value of 0.004.

```{R}

CarnforthCCA8 <- cca(CarnforthPS ~ Na2O + Co +SrO + Al2O3 + Ba + MgO,
                     data = CarnforthPC)

print(CarnforthCCA8)
plot(CarnforthCCA8)
anova(CarnforthCCA8)

```

#An F statistic of 1.2206 and a p value of 0.079.

```{R}

CarnforthCCA9 <- cca(CarnforthPS ~ Na2O + Co +SrO + Al2O3 + Cr2O3 + MgO,
                     data = CarnforthPC)

print(CarnforthCCA9)
plot(CarnforthCCA9)
anova(CarnforthCCA9)

```

#An F statistic of 1.0866 and a p value of 0.192.

```{R}

CarnforthCCA9 <- cca(CarnforthPS ~ Na2O + Co +SrO + Al2O3 + Cd + MgO,
                     data = CarnforthPC)

print(CarnforthCCA9)
plot(CarnforthCCA9)
anova(CarnforthCCA9)

```

#An F statistic of 1.6389 and a low p value of 0.001.

```{R}

CarnforthCCA10 <- cca(CarnforthPS ~ Na2O + Co +SrO + Cd + Calcite + MgO,
                     data = CarnforthPC)

print(CarnforthCCA10)
plot(CarnforthCCA10)
anova(CarnforthCCA10)

#An F statistic of 1.6287 and a low p value of 0.001.

#After doing several CCAs with different combinations of chemical variables, the one with 
#the highest F statistic, 1.6947, is CarnforthCCA2. This CCA also has a low p value of
#0.001. The plot for this one looks good, but it can be made to be a little neater and 
#easier to interpret...

```

```{R}

options(max.print=1000000)

CarnforthCCA2$CCA$v

#The "v values" show the positions of individual species on the graph, with the CCA1 value
#representing the x axis and the CCA2 value representing the y axis, in the case of the
#graph created in R.

plot(CarnforthCCA2, xlim = c(-5, 5), ylim = c(-5, 5)) 

#Increasing the xlim and ylim to give more room for writing on graph

plot(CarnforthCCA2,, choices = c(1,2), display = c("wa", "bp"), xlim = c(-4, 3),
     ylim = c(-3, 2))

#Increasing the xlim and ylim to give more room for writing on graph Note that Community
#1 and Community 2 are grouped/clustered together in this CCA plot.

points(x = 0.70197267, y = 1.9144914, pch = 15, col = "black")

#This point represents Alopercus pratensis

text('A. pratensis', x = 0.70197267, y = 1.9144914, cex = 0.88, pos = 2, col = "black")

#Adding text to this point.

points(x = -0.63005543, y = -0.1744372, pch = 15, col = "black")

#This point represents Pilosella officinarum

text('P. officinarum', x = -0.63005543, y = -0.1744372, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = 2.78627371 , y = -2.1170901, pch = 15, col = "black")

#This point represents Centaurium pulchellum

text('C. pulchellum', x = 2.78627371, y = -2.1170901, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = -1.03489039, y = -1.3036717, pch = 15, col = "black")

#This point represents Fissidens exilis

text('F. exilis', x = -1.03489039, y = -1.3036717, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = 0.27967260, y = 0.4821115, pch = 15, col = "black")

#This point represents Homalothecium lutescens

text('H. lutescens', x = 0.27967260, y = 0.4821115, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

```


##Hodbarrow Data##

```{R}

urlfile13 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/HodbarrowPlantSpecies.csv'

HodbarrowPS <- read.csv("HodbarrowPlantSpecies.csv",  header = TRUE, colClasses = c("numeric"))

urlfile13 <- 'https://raw.githubusercontent.com/Savannankvm/Canonical-Correspondence-analyses-six-study-sites-PhD/PhD-files/HodbarrowPlantChemistry.csv'

HodbarrowPC <-read.csv("HodbarrowPlantChemistry.csv", header = TRUE, 
                       colClasses = c("numeric"))

head(HodbarrowPS)
head(HodbarrowPC)

rowSums(HodbarrowPS)

```

```{R}

#Again, ANOSIMs will be carried out to see if there are any statistically significant
#differences between plants in different concentrations of elements.

anoHSiO2 <- anosim(HodbarrowPS, HodbarrowPC$SiO2, distance = "bray", permutations = 9999)

anoHSiO2

#This ANOSIM has a high ANOSIM statistic of 1 and a low p value of 0.047619, showing that
#there are statistically significant differences between plants in different silicon
#concentrations on the Hodbarrow site.

#anoHAl2O3 <- anosim(HodbarrowPS, HodbarrowPC$Al2O3, distance = "bray", permutations = 9999)

#When this ANOSIM is run, the error message: "there should be replicates within groups"
#comes up. This error message comes up for another substrate variables for the Hodbarrow
#data. From now on, only variables that were tested successfully will be included.

anoHCr2O3 <- anosim(HodbarrowPS, HodbarrowPC$Cr2O3, distance = "bray", permutations = 9999)

anoHCr2O3

#This ANOSIM has a high R statistic of 0.963 and a low p value of 0.0095238. This shows that
#there are significant differences between plants growing in different concentrations of
#Cr2O3.

anoHTiO2 <- anosim(HodbarrowPS, HodbarrowPC$TiO2, distance = "bray", permutations = 9999)

anoHTiO2

anoHMnO <- anosim(HodbarrowPS, HodbarrowPC$MnO, distance = "bray", permutations = 9999)

anoHMnO

anoHP2O5 <- anosim(HodbarrowPS, HodbarrowPC$P2O5, distance = "bray", permutations = 9999)

anoHP2O5

#This ANOSIM has a high R statistic of 0.963 and a low p value of 0.0095238. There are
#significant differences between plants in different concentrations of P2O5 in
#Hodbarrow.

anoHSrO <- anosim(HodbarrowPS, HodbarrowPC$SrO, distance = "bray", permutations = 9999)

anoHSrO

#This ANOSIM has an R statistic of 0.5556 and a p value of 0.047619. This shows that there
#are significant differences between plants growing in different concentrations of SrO
#in Hodbarrow, although the R statistic indicates that this isn't quite as strong as the
#differences seen in, say, SiO2, or Cr2O3.

anoHBaO <- anosim(HodbarrowPS, HodbarrowPC$BaO, distance = "bray", permutations = 9999)

anoHBaO

anoHAg <- anosim(HodbarrowPS, HodbarrowPC$Ag, distance = "bray", permutations = 9999)

anoHAg

anoHAs <- anosim(HodbarrowPS, HodbarrowPC$As, distance = "bray", permutations = 9999)

anoHAs

anoHB <- anosim(HodbarrowPS, HodbarrowPC$B, distance = "bray", permutations = 9999)

anoHB

anoHBa <- anosim(HodbarrowPS, HodbarrowPC$Ba, distance = "bray", permutations = 9999)

anoHBa

anoHCo <- anosim(HodbarrowPS, HodbarrowPC$Co, distance = "bray", permutations = 9999)

anoHCo

#This ANOSIM has a high R statistic of 0.8421 and a low p value of 0.038095. This
#demonstrates that plants are significantly different in differing concentrations of Co at
#Hodbarrow.

anoHCr <- anosim(HodbarrowPS, HodbarrowPC$Cr, distance = "bray", permutations = 9999)

anoHCr

anoHCu <- anosim(HodbarrowPS, HodbarrowPC$Cu, distance = "bray", permutations = 9999)

anoHCu

anoHMg <- anosim(HodbarrowPS, HodbarrowPC$Mg, distance = "bray", permutations = 9999)

anoHMg

anoHNi <- anosim(HodbarrowPS, HodbarrowPC$Ni, distance = "bray", permutations = 9999)

anoHNi

#This ANOSIM has a high R statistic of 1 and a low p value of 0.047619. This demonstrates
#significant differences between plants growing in different concentrations of Ni at
#Hodbarrow.

anoHS <- anosim(HodbarrowPS, HodbarrowPC$S, distance = "bray", permutations = 9999)

anoHS

#With a high R statistic of 1 and a low p value of 0.047619, this ANOSIM shows that there
#are significant differences between plants growing in different concentraitons of S at
#Hodbarrow.

anoHSb <- anosim(HodbarrowPS, HodbarrowPC$Sb, distance = "bray", permutations = 9999)

anoHSb

#This ANOSIM has a high R statistic of 0.8421 and a low p value of 0.038095, showing that
#plants significantly differ in different concentrations of Sb at Hodbarrow.

anoHSc <- anosim(HodbarrowPS, HodbarrowPC$Sc, distance = "bray", permutations = 9999)

anoHSc

anoHTi <- anosim(HodbarrowPS, HodbarrowPC$Ti, distance = "bray", permutations = 9999)

anoHTi

anoHV <- anosim(HodbarrowPS, HodbarrowPC$V, distance = "bray", permutations = 9999)

anoHV

#After carrying ANOSIMs for all of the geochemical variables, several of them demonstrated
#significant differences in terms of their relation to plant growth. CCA plots will better
#represent the data than NMDS plots, so some will be generated now to find the most
#appropriate CCA for the data.

```

```{R}


HodbarrowCCA <- cca(HodbarrowPS, HodbarrowPC)

print(HodbarrowCCA)
plot(HodbarrowCCA)

HodbarrowCCA1 <- cca(HodbarrowPS ~ CaO + Al2O3 + SiO2,
                     data = HodbarrowPC)

print(HodbarrowCCA1)
plot(HodbarrowCCA1)
anova(HodbarrowCCA1)

```

#High F statistic of 2.9878 and low p value of 0.001.

#With such a high F statistic, it may be tempting to say that this is the most suitable
#CCA, but a few more can be constructed, including with some of the variables that
#were shown to be significant in the ANOSIMs.

```{R}

HodbarrowCCA2 <- cca(HodbarrowPS ~ SiO2 + Cr2O3 + P2O5,
                     data = HodbarrowPC)

print(HodbarrowCCA2)
plot(HodbarrowCCA2)
anova(HodbarrowCCA2)

```

#High F statistic of 2.7373 and low p value of 0.001.

```{R}

HodbarrowCCA3 <- cca(HodbarrowPS ~ SrO + Co + Ni,
                     data = HodbarrowPC)

print(HodbarrowCCA3)
plot(HodbarrowCCA3)
anova(HodbarrowCCA3)

```

#F statistic of 1.6452 and p value of 0.057.

```{R}

HodbarrowCCA3 <- cca(HodbarrowPS ~ SrO + Co + Ni,
                     data = HodbarrowPC)

print(HodbarrowCCA3)
plot(HodbarrowCCA3)
anova(HodbarrowCCA3)

```

#F statistic of 1.6452 and p value of 0.057.

```{R}

HodbarrowCCA4 <- cca(HodbarrowPS ~ S + Sb + Ni,
                     data = HodbarrowPC)

print(HodbarrowCCA4)
plot(HodbarrowCCA4)
anova(HodbarrowCCA4)

```

#High F statistic of 1.9596 and p value of 0.017.

```{R}

HodbarrowCCA5 <- cca(HodbarrowPS ~ Ag + Al + As,
                     data = HodbarrowPC)

print(HodbarrowCCA5)
plot(HodbarrowCCA5)
anova(HodbarrowCCA5)

```

#High F statistic of 2.6385 and low p value of 0.001.

```{R}

HodbarrowCCA6 <- cca(HodbarrowPS ~ Ag + Al + As + SiO2,
                     data = HodbarrowPC)

print(HodbarrowCCA6)
plot(HodbarrowCCA6)
anova(HodbarrowCCA6)

```

#High F statistic of 2.4576 and low p value of 0.006.

```{R}

HodbarrowCCA7 <- cca(HodbarrowPS ~ Ag + Al + As + Cr2O3,
                     data = HodbarrowPC)

print(HodbarrowCCA7)
plot(HodbarrowCCA7)
anova(HodbarrowCCA7)

```

#High F statistic of 2.6794 and low p value of 0.003.

```{R}

HodbarrowCCA8 <- cca(HodbarrowPS ~ SiO2 + Al + As + Cr2O3,
                     data = HodbarrowPC)

print(HodbarrowCCA8)
plot(HodbarrowCCA8)
anova(HodbarrowCCA8)

```

#High F statistic of 2.3672 and low p value of 0.006.

```{R}

HodbarrowCCA9 <- cca(HodbarrowPS ~ Ag + Al + As + P2O5,
                     data = HodbarrowPC)

print(HodbarrowCCA9)
plot(HodbarrowCCA9)
anova(HodbarrowCCA9)

```

#High F statistic of 2.5973 and low p value of 0.005.

```{R}

HodbarrowCCA10 <- cca(HodbarrowPS ~ Ag + Al + As + Cr2O3 + SiO2,
                     data = HodbarrowPC)

print(HodbarrowCCA10)
plot(HodbarrowCCA10)
anova(HodbarrowCCA10)

```

#F statistic of 1.86 and p value of 0.02.

```{R}

HodbarrowCCA11 <- cca(HodbarrowPS ~ Cd + Mo + Ba + V + Na,
                      data = HodbarrowPC)

print(HodbarrowCCA11)
plot(HodbarrowCCA11)
anova(HodbarrowCCA11)

```

#High F statistic of 2.1267 and p value of 0.01.

```{R}

HodbarrowCCA12 <- cca(HodbarrowPS ~ Cr + Be + Ba + Zn + Ti,
                      data = HodbarrowPC)

print(HodbarrowCCA12)
plot(HodbarrowCCA12)
anova(HodbarrowCCA12)

```

#High F statistic of 4.9646 and p value of 0.001.

```{R}

HodbarrowCCA13 <- cca(HodbarrowPS ~ Cr + Be + Ba + SiO2 + Ti,
                      data = HodbarrowPC)

print(HodbarrowCCA13)
plot(HodbarrowCCA13)
anova(HodbarrowCCA13)

```

#High F statistic of 2.7035 and p value of 0.001.

```{R}

HodbarrowCCA14 <- cca(HodbarrowPS ~ Cr + SiO2 + Ba + Zn + Ti,
                      data = HodbarrowPC)

print(HodbarrowCCA14)
plot(HodbarrowCCA14)
anova(HodbarrowCCA14)

```

#High F statistic of 5.5114 and p value of 0.001.

```{R}

HodbarrowCCA15 <- cca(HodbarrowPS ~ Cr2O3 + SiO2 + Ba + Zn + Ti,
                      data = HodbarrowPC)

print(HodbarrowCCA15)
plot(HodbarrowCCA15)
anova(HodbarrowCCA15)

```

#High F statistic of 3.292 and p value of 0.002.

```{R}

HodbarrowCCA16 <- cca(HodbarrowPS ~ Cr + SiO2 + Ba + Ti + pH_level,
                      data = HodbarrowPC)

print(HodbarrowCCA16)
plot(HodbarrowCCA16)
anova(HodbarrowCCA16)

```

#High F statistic of 3.9366 and p value of 0.002.

#After doing a few more CCAs, the one with the highest F statistic (5.5114) is 
#HodbarrowCCA14. The p value of this one is also low, at 0.001.
#The plot for this CCA looks OK, but it can be modified to make it easier 
#to interpret what is going on with some of the different plant species and communities.

```

```{R}

options(max.print=1000000)

HodbarrowCCA14$CCA$v

#The "v values" show the positions of individual species on the graph, with the CCA1 value
#representing the x axis and the CCA2 value representing the y axis, in the case of the
#graph created in R.

plot(HodbarrowCCA14, xlim = c(-5, 5), ylim = c(-5, 5)) 

#Increasing the xlim and ylim to give more room for writing on graph

plot(HodbarrowCCA14,, choices = c(1,2), display = c("wa", "bp"), xlim = c(-4, 3),
     ylim = c(-3, 2))

#Increasing the xlim and ylim to give more room for writing on graph Note that Community
#2 and Community 3 are grouped/clustered together in this CCA plot and that Communities
#1, 5, 6 and 7 are grouped together.

points(x = -1.88216580 , y = 0.508955374, pch = 15, col = "black")

#This point represents Equisetum variegatum

text('E. variegatum', x = -1.88216580, y = 0.508955374, cex = 0.88, pos = 2, col = "black")

#Adding text to this point.

points(x = 0.59361261 , y = 0.322574196, pch = 15, col = "black")

#This point represents Poa annua

text('P. annua', x = 0.59361261 , y = 0.322574196, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = 0.12634572 , y = -2.204178021, pch = 15, col = "black")

#This point represents Trifolium pratense

text('T. pratense', x = 0.12634572, y = -2.204178021, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = 0.35615163, y = -1.518543516, pch = 15, col = "black")

#This point represents Linum catharticum

text('L. catharticum', x = 0.35615163, y = -1.518543516, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

points(x = 0.83418865, y = 1.046910474, pch = 15, col = "black")

#This point represents Anthyllis vulneraria

text('A. vulneraria', x = 0.83418865, y = 1.046910474, cex = 0.88, pos = 2, col = "black")

#Adding text to this point

```


